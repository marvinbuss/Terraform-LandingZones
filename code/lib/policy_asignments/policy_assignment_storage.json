{
  "type": "Microsoft.Authorization/policyAssignments",
  "name": "Cmplnt-Storage",
  "apiVersion": "2019-09-01",
  "properties": {
    "displayName": "Enforce secure-by-default Storage Account for Financial Services Industry",
    "description": "This policy initiative is a group of policies that ensures Storage is compliant per FSI Landing Zones",
    "notScopes": [],
    "parameters": {
      "storageKeysExpiration": {
        "value": "Deny"
      },
      "modifyStorageFileSyncPublicEndpoint": {
        "value": "Modify"
      },
      "storageFileSyncPublicEndpoint": {
        "value": "Deny"
      },
      "storageAccountNetworkRules": {
        "value": "Deny"
      },
      "storageAccountRestrictNetworkRules": {
        "value": "Deny"
      },
      "storageThreatProtection": {
        "value": "DeployIfNotExists"
      },
      "storageClassicToArm": {
        "value": "Deny"
      },
      "storageAccountSecureTransfer": {
        "value": "Deny"
      },
      "storageAccountsInfraEncryption": {
        "value": "Deny"
      },
      "storageAccountsPublicAccess": {
        "value": "Deny"
      },
      "storageAccountsCmk": {
        "value": "Deny"
      },
      "storageTableCmk": {
        "value": "Deny"
      },
      "storageAccountSharedKey": {
        "value": "Deny"
      },
      "storageAccountsCrossTenant": {
        "value": "Deny"
      },
      "storageAccountsModifyDisablePublicNetworkAccess": {
        "value": "Modify"
      },
      "storageAccountsDisablePublicNetworkAccess": {
        "value": "Deny"
      },
      "storageAccountsDoubleEncryption": {
        "value": "Deny"
      },
      "storageQueueCmk": {
        "value": "Deny"
      },
      "storageAccountsTls": {
        "value": "Deny"
      },
      "storageAccountsEncryptionCmk": {
        "value": "Deny"
      },
      "storageAccountsCopyScope": {
        "value": "Deny"
      },
      "storageAccountsAllowedCopyScope": {
        "value": "AAD"
      },
      "storageServicesEncryption": {
        "value": "Deny"
      },
      "storageSftp": {
        "value": "Deny"
      },
      "storageNetworkAclsBypass": {
        "value": "Deny"
      },
      "storageAllowedNetworkAclsBypass": {
        "type": "array",
        "value": [
          "None"
        ]
      },
      "storageResourceAccessRulesTenantId": {
        "value": "Deny"
      },
      "storageResourceAccessRulesResourceId": {
        "value": "Deny"
      },
      "storageNetworkAclsVirtualNetworkRules": {
        "value": "Deny"
      },
      "storageAllowBlobPublicAccess": {
        "value": "Deny"
      },
      "storageContainerDeleteRetentionPolicy": {
        "value": "Deny"
      },
      "storageMinContainerDeleteRetentionInDays": {
        "type": "Integer",
        "value": 7
      },
      "storageCorsRules": {
        "value": "Deny"
      },
      "modifyStorageAccountPublicEndpoint": {
        "value": "Modify"
      }
    },
    "policyDefinitionId": "${root_scope_resource_id}/providers/Microsoft.Authorization/policySetDefinitions/Cmplnt-Storage",
    "nonComplianceMessages": [
      {
        "message": "Compliant Storage Account required {enforcementMode}."
      }
    ],
    "scope": "${current_scope_resource_id}",
    "enforcementMode": null
  },
  "location": "${default_location}",
  "identity": {
    "type": "SystemAssigned"
  }
}
